import re
import random
import datetime

class TravelBuddy:
    def __init__(self):
        self.user_profile = {
            'visited_places': [],
            'wishlist': [],
            'travel_style': None,
            'budget_range': None
        }
        
        self.patterns = [
            # Θέλω να πάω κάπου
            {
                'pattern': r'(θέλω να πάω|θα ήθελα να ταξιδέψω|σκέφτομαι να πάω)\s+(στην?|στο|στα|στις)?\s*(.*)',
                'responses': [
                    'Ωραία επιλογή {2}! Τι εποχή σκέφτεσαι να πας;',
                    'Η {2} είναι υπέροχη! Έχεις κάποιον προϋπολογισμό κατά νου;',
                    'Τέλεια! Στην {2} θα χρειαστείς περίπου μια εβδομάδα. Πόσες μέρες σκέφτεσαι;',
                    'Υπέροχη ιδέα η {2}! Ξέρεις τι σε ενδιαφέρει περισσότερο εκεί;'
                ]
            },
            
            # Έχω πάει κάπου
            {
                'pattern': r'(έχω πάει|έχω ταξιδέψει|πήγα)\s+(στην?|στο|στα|στις)?\s*(.*)',
                'responses': [
                    'Πώς ήταν {2}; Τι σου άρεσε περισσότερο;',
                    'Ωραίος! Θα ξαναπήγαινες {2};',
                    'Τι θα πρότεινες σε κάποιον που θέλει να πάει {2};',
                    'Τέλεια! Πόσες μέρες έμεινες {2};'
                ]
            },
            # Προϋπολογισμός
            {
                'pattern': r'.*(έχω|μπορώ να ξοδέψω|διαθέτω).*?(\d+)\s*(ευρώ|€)',
                'responses': [
                     'Με {1}€ έχεις πολλές επιλογές! Προτιμάς εσωτερικό ή εξωτερικό;',
                     '{1}€ είναι καλός προϋπολογισμός! Τι στυλ ταξιδιού προτιμάς;',
                     'Ωραία! Με {1}€ μπορείς να κάνεις ένα τέλειο ταξίδι! Λες σε καμιά πόλη ή φύση;'
    ]
            },
            
            # Εποχή ταξιδιού
            {
                'pattern': r'(το καλοκαίρι|τον χειμώνα|την άνοιξη|το φθινόπωρο)\s*(.*)',
                'responses': [
                    'Τέλεια εποχή {0}! Έχεις σκεφτεί προορισμό;',
                    '{0} είναι υπέροχα για ταξίδια! Τι είδους εμπειρία ψάχνεις;',
                    'Καλή επιλογή {0}! Θάλασσα, βουνό ή πόλη;'
                ]
            },
            
            # Τύπος διακοπών
            {
                'pattern': r'(μου αρέσει)\s*(η θάλασσα|το βουνό|η φύση|η νυχτερινή ζωή|το φαγητό)',
                'responses': [
                    'Ωραίος! {1} είναι τοπ! Έχεις κάποιον συγκεκριμένο προορισμό κατά νου;',
                    'Η αγαπημένη μου επιλογή! {1} προσφέρει τόσες εμπειρίες! Τι άλλο σε ενδιαφέρει;',
                    'Τέλεια! Για {1} έχω πολλές προτάσεις! Προϋπολογισμός;'
                ]
            },
            
            # Αεροπλάνο/μεταφορά
            {
                'pattern': r'(φοβάμαι το αεροπλάνο|δεν μου αρέσει να πετάω)',
                'responses': [
                    'Καταλαβαίνω! Υπάρχουν πολλοί τρόποι να ταξιδέψεις! Road trip ίσως;',
                    'Μην αγχώ! Μπορούμε να βρούμε εναλλακτικές! Τι προτιμάς;',
                    'Καταλαβαίνω απόλυτα! Ούτε εμένα μου αρέσουν τα ύψη!'
                ]
            },
            
            # Διάρκεια ταξιδιού
            {
                'pattern': r'(για|έχω|διαθέσιμες)\s*(\d+)\s*(μέρες|εβδομάδες|μήνα|μήνες)',
                'responses': [
                    'Τέλεια! {1} {2} είναι καλός χρόνος! Τι είδους ταξίδι θες;',
                    '{1} {2} - perfect timing! Έχεις σκεφτεί προορισμό;',
                    'Τέλεια! Με {1} {2} μπορείς να κάνεις ένα υπέροχο ταξίδι!'
                ]
            },
            
            # Φαγητό
            {
                'pattern': r'(λατρεύω|θέλω να δοκιμάσω)\s*(το ιταλικό φαγητό|την ασιατική κουζίνα|μεξικάνικη κουζίνα)',
                'responses': [
                     'Ωραίος! {1} είναι incredible! Έχεις σκεφτεί συγκεκριμένη χώρα;',
                     'Yummy! {1} θα σου αρέσει πολύ! Πού θα ήθελες να το ζήσεις;',
                     'Τέλεια! {1} είναι αξέχαστη εμπειρία! Food tour ίσως;'
                ]
            },
            
            # Τι χρειάζεσαι
            {
                'pattern': r'(θέλω|ψάχνω)\s*(περιπέτεια|χαλάρωση|αδρεναλίνη)',
                'responses': [
                    'Ωραία! {1}  είναι ότι καλύτερο! Τι σε ενδιαφέρει συγκεκριμένα;',
                    'Perfect choice! Για {1} έχω πολλές ιδέες! Προορισμός;',
                    'Το λατρεύω! Η {1} είναι ακριβώς αυτό που χρείαζεσαι! Πού σκέφτεσαι;'
                ]
            },
            
            # Καιρός/κλίμα
            {
                'pattern': r'(θέλω|προτιμώ)\s*(κρύο|μαύρισμα|χιόνι|μεσογειακό κλίμα)',
                'responses': [
                    'Τέλεια! {1} είναι υπέροχο! Έχω πολλές προτάσεις για εσένα!',
                    'Τέλεια επιλογή! Σου προσφέρει πολλές επιλογές! Τι άλλο θες;',
                    'Perfect! Για {1} ξέρω τέλειους προορισμούς!'
                ]
            }
        ]
        
        self.default_responses = [
            'Ενδιαφέρον! Πες μου περισσότερα για το ταξίδι που σκέφτεσαι!',
            'Ακούγεται τέλειο! Τι είδους ταξιδιωτικές εμπειρίες προτιμάς;',
            'Ωραία! Έχεις κάποιον προορισμό στο μυαλό σου;',
            'Τοπ! Προϋπολογισμός και διάρκεια τι λες;',
            'Υπέροχα! Θάλασσα, βουνό ή πόλη;',
            'Απίστευτα! Τι σε κάνει να νιώθεις ενθουσιασμένος για ταξίδια;',
            'Perfect! Πες μου τι σε ενδιαφέρει περισσότερο στα ταξίδια!',
            'Ουάου! Solo travel ή με παρέα;'
        ]
        
        self.travel_tips = [
            "💡 Tip: Κάνε πάντα backup των εγγράφων σου!",
            "💡 Tip: Κατέβασε offline maps πριν φύγεις!",
            "💡 Tip: Μάθε μερικές βασικές φράσεις στη τοπική γλώσσα!",
            "💡 Tip: Μην γεμίσεις την βαλίτσα, θα με ευχαριστήσεις αργότερα!!",
            "💡 Tip: Κράτα πάντα τα φάρμακά σου κοντά!"
        ]
    
    def get_random_tip(self):
        return random.choice(self.travel_tips)
    
    def respond(self, user_input):
        user_input = user_input.lower().strip()
        
        # Έλεγχος για τερματισμό
        if user_input in ['αντίο', 'bye', 'τέλος', 'καλό ταξίδι', 'thanks']:
            tips = self.get_random_tip()
            return f'Καλά ταξίδια! {tips} ✈️🌍'
        
        # Ειδικές λέξεις κλειδιά για tips
        if 'tip' in user_input or 'συμβουλή' in user_input:
            return self.get_random_tip()
        
            for pattern_dict in self.patterns:
            match = re.search(pattern_dict['pattern'], user_input, re.IGNORECASE)
            if match:
                response_template = random.choice(pattern_dict['responses'])
                try:
                    if match.groups():
                        # Καθαρισμός captured groups
                        groups = []
                        for group in match.groups():
                            if group:
                                # Καθαρισμός άρθρων και προθέσεων
                                clean_group = group.strip()
                                if clean_group.startswith(('την ', 'το ', 'τα ', 'στην ', 'στο ', 'στα ')):
                                    clean_group = clean_group.split(' ', 1)[1] if ' ' in clean_group else clean_group
                                groups.append(clean_group)
                            else:
                                groups.append('')
                        
                        response = response_template.format(*groups)
                        return response
                    else:
                        return response_template
                except:
                    return response_template
        
        # Αν δεν βρεθεί αντιστοίχιση, γενική απάντηση
        return random.choice(self.default_responses)
    
    def chat(self):
        print("✈️ Γεια σου! Είμαι ο Travel Buddy σου!")
        print("Μπορώ να σε βοηθήσω να σχεδιάσεις το επόμενο ταξίδι σου!")
        print("Πες μου για προορισμούς, προϋπολογισμό, προτιμήσεις και ό,τι άλλο θέλεις!")
        print("Γράψε 'αντίο' για να τελειώσουμε!\n")
        
        while True:
            user_input = input("Εσύ: ")
            response = self.respond(user_input)
            print(f"🧳 Travel Buddy: {response}\n")
            
            if user_input.lower() in ['αντίο', 'bye', 'τέλος', 'καλό ταξίδι', 'thanks']:
                break

# Εκτέλεση του chatbot
if __name__ == "__main__":
    bot = TravelBuddy()
    bot.chat()